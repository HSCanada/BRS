-- Market Adjustment 2021, tmc, 31 Dec 20
-- update rules as per execs, tmc 27 Jan 21

select  [Supplier], [ma_supplier_factor] from BRS_ItemSupplier where [ma_supplier_factor] > 0

select distinct [ma_base_factor] from BRS_ItemLabel
	
select distinct [ma_stocking_factor] from BRS_ItemStocking

select [ma_heavy_thresh], [ma_heavy_factor] from [BRS_Config]

/*
8	2021 - Added additional Corporate adjustment of 5% on Milestone merchandise products
9	2021 - Added additional Corporate adjustment of 3% on Denmat merchandise products
10	2021 - Added additional Corporate adjustment of 3% on Isolite merchandise products
*/


UPDATE [dbo].[BRS_ItemSupplier]
   SET 
      [ma_supplier_factor] = 0.05
 WHERE [Supplier] = 'WAND'
GO

UPDATE [dbo].[BRS_ItemSupplier]
   SET 
      [ma_supplier_factor] = 0.05
 WHERE [Supplier] in( 'DECMAT', 'ZYRISI')
GO

-- update to 10%, 27 Jan 21
UPDATE [dbo].[BRS_ItemSupplier]
   SET 
      [ma_supplier_factor] = 0.10
 WHERE [Supplier] in( 'USENDO', 'ORTHOT')
GO


/*
2	Increase Merchandise Branded Marketing Adjustment from 8.5% to 9.2%
3	Increase Merchandise Private Label Marketing Adjustment from 11.5% to 12.2%
*/

select  [Label], [ma_base_factor] from [BRS_ItemLabel]

-- update rate 27 Jan 21
UPDATE [dbo].[BRS_ItemLabel]
   SET 
      [ma_base_factor] = 1.123
 WHERE [Label] = 'P'
GO

UPDATE [dbo].[BRS_ItemLabel]
   SET 
      [ma_base_factor] = 1.092
 WHERE [Label] <> 'P'
GO

/*
1	2020 Review of Freight Factors and remove cap										
		- remove cap of 9.2% Branded and 12.2% Private Label for freight factors above 4.0%									
		(for freight factors above 4.0% use a Marketing factor of 1.059 for Branded and 1.088 for Private Label)									
		- if freight factor is 4.0% or below, limit total MA to 9.2% Branded, 12.2% PL									
*/

UPDATE [BRS_Config]
SET
	[ma_heavy_factor] = 0.033
GO

SELECT        Item, ItemDescription, [SubMajorProdClass], ItemStatus
FROM            BRS_Item
WHERE     

	(Item IN ('1671450', '1672540', '1672583', '1676434', '1676594', '2283013', '2283533', '2284506', '2286569', '2288490', '5441450', '5445743', '5820370', '5821324', '5822060', '5824559', '5828302', '5828531', '5829551', 
                         '5834239', '5835974', '5838393', '5838638', '5838699', '5839986', '5848192', '5848500', '5850813', '5852333', '5855411', '5855412', '5855417', '5855418', '5855419', '5855420', '5855421', '5855422', '5855423', '5855424', 
                         '5855467', '5855468', '5855469', '5855470', '5855471', '5855479', '6528956', '6528959', '8096775', '8099123', '9490170', '9496591', '9496592', '9497429', '9497430', '9497466', '9497467', '9498526', '9498529', '9498881', 
                         '9498887')) AND 

	(Item  IN ('1676434', '1676594', '9496591', '9496592', '9497430', '5855411', '5855418', '5855419', '5855420', '5855424', '5834239', '5838699', '5839986', '9498526', '9498529', '9498881', '9498887', '9497466', 
                         '9497467', '5445743', '5852333', '5855469', '5855470', '5855479', '8096775', '5835974', '8099123', '5838638'))
GO


/*
-- set current items
UPDATE       BRS_Item
SET                comm_group_cd = 'ITMTEE'
WHERE        (Item IN ('1671450', '1672540', '1672583', '1676434', '1676594', '2283013', '2283533', '2284506', '2286569', '2288490', '5441450', '5445743', '5820370', '5821324', '5822060', '5824559', '5828302', '5828531', '5829551', 
                         '5834239', '5835974', '5838393', '5838638', '5838699', '5839986', '5848192', '5848500', '5850813', '5852333', '5855411', '5855412', '5855417', '5855418', '5855419', '5855420', '5855421', '5855422', '5855423', '5855424', 
                         '5855467', '5855468', '5855469', '5855470', '5855471', '5855479', '6528956', '6528959', '8096775', '8099123', '9490170', '9496591', '9496592', '9497429', '9497430', '9497466', '9497467', '9498526', '9498529', '9498881', 
                         '9498887'))
GO

UPDATE       BRS_Item
SET                comm_group_cd = 'ITMTEM'
WHERE        (Item IN ('1670442', '1670444', '1671240', '1671470', '1672460', '1672767', '1674691', '1674692', '1674694', '1674695', '5444501', '5444513', '5445782', '5445859', '5820682', '5821933', '5826383', '5852331', '5852332', 
                         '5855413', '5855425', '5855426', '5855427', '5855445', '5855446', '5855456', '5855457', '5855458', '5855459', '5855460', '5855462', '5855463', '5855472', '5877105', '5877106', '5884362', '5884363', '5884594', '5884775', 
                         '5884999', '5885096', '5885349', '5887135', '5888052', '5888141', '5888923', '5889544', '6650516', '6650517', '6650518', '6650519', '9491245', '9492403', '9497442', '9497443', '9498536', '9498537', '9498897', '9498898'))
GO

UPDATE       BRS_Item
SET                comm_group_cd = 'ITMTEP'
WHERE        (Item IN ('1670114', '1670573', '1670951', '1671001', '1671451', '1671509', '1671510', '1671530', '1671589', '1672239', '1672520', '1672830', '1673962', '1674082', '1674163', '1674326', '1675612', '1675679', '1675969', 
                         '1676701', '1678205', '3334275', '3339436', '5440517', '5445298', '5445723', '5445732', '5445759', '5445791', '5445794', '5445844', '5827294', '5828313', '5831513', '5832110', '5832244', '5832641', '5834987', '5838146', 
                         '5838660', '5839196', '5839792', '5850770', '5850812', '5850814', '5850815', '5850818', '5850819', '5852328', '5852329', '5852334', '5852335', '5852336', '5854180', '5854198', '5854199', '5854201', '5854202', '5854203', 
                         '5855405', '5855406', '5855408', '5855409', '5855410', '5855414', '5855431', '5855434', '5855435', '5855436', '5855437', '5855438', '5855439', '5855440', '5855455', '5855461', '5855464', '5855465', '5855466', '5855475', 
                         '5855476', '5855477', '5857390', '5857391', '5857523', '5857524', '5857525', '5857526', '5872015', '5875329', '5875330', '5875339', '5875341', '5876028', '5877073', '5877114', '5878391', '5878517', '5884566', '5884567', 
                         '5884569', '5884570', '5884832', '5885646', '5886136', '5886364', '5886425', '5888634', '5888822', '5888823', '5888825', '5888899', '5891989', '5892124', '5893704', '5894152', '6522936', '6523685', '6525202', '6528693', 
                         '8091249', '8092069', '9491269', '9491270', '9496968', '9497427', '9498725', '9498726', '9498727', '9498728', '9498733', '9498734', '9498735', '9498736', '9498906'))
GO
*/