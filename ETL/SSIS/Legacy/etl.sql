

--------------------------------------------------------------------------------
-- DROP TABLE etl.F4101_item_master
--------------------------------------------------------------------------------

SELECT 

    Top 5 
    "IMITM" AS IMITM__item_number_short, "IMLITM" AS IMLITM_item_number, "IMAITM" AS IMAITM__3rd_item_number, "IMDSC1" AS IMDSC1_description, "IMDSC2" AS IMDSC2_description_2, "IMSRTX" AS IMSRTX_search_text, "IMALN" AS IMALN__search_text_compressed, "IMSRP1" AS IMSRP1_sales_catalog_section, "IMSRP2" AS IMSRP2_sub_section, "IMSRP3" AS IMSRP3_sales_category_code_3, "IMSRP4" AS IMSRP4_sales_category_code_4, "IMSRP5" AS IMSRP5_sales_category_code_5, "IMSRP6" AS IMSRP6_category_code_6, "IMSRP7" AS IMSRP7_category_code_7, "IMSRP8" AS IMSRP8_category_code_8, "IMSRP9" AS IMSRP9_category_code_9, "IMSRP0" AS IMSRP0_category_code_10, "IMPRP1" AS IMPRP1_commodity_class, "IMPRP2" AS IMPRP2_commodity_sub_class, "IMPRP3" AS IMPRP3_supplier_rebate_code, "IMPRP4" AS IMPRP4_master_planning_family, "IMPRP5" AS IMPRP5_landed_cost_rule, "IMPRP6" AS IMPRP6_item_dimension_group, "IMPRP7" AS IMPRP7_warehouse_process_grp_1, "IMPRP8" AS IMPRP8_warehouse_process_grp_2, "IMPRP9" AS IMPRP9_warehouse_process_grp_3, "IMPRP0" AS IMPRP0_item_pool_code, "IMCDCD" AS IMCDCD_commodity_code, "IMPDGR" AS IMPDGR_product_group, "IMDSGP" AS IMDSGP_dispatch_group, "IMPRGR" AS IMPRGR_item_price_group, "IMRPRC" AS IMRPRC_basket_reprice_group, "IMORPR" AS IMORPR_order_reprice_group, "IMBUYR" AS IMBUYR_buyer_number, "IMDRAW" AS IMDRAW_drawing_number, "IMRVNO" AS IMRVNO_last_revision_no, "IMDSZE" AS IMDSZE_drawing_size, "IMVCUD" AS IMVCUD_volume_cubic_dimensions, "IMCARS" AS IMCARS_carrier_number, "IMCARP" AS IMCARP_preferred_carrier_purchasing, "IMSHCN" AS IMSHCN_shipping_conditions_code, "IMSHCM" AS IMSHCM_shipping_commodity_class, "IMUOM1" AS IMUOM1_unit_of_measure, "IMUOM2" AS IMUOM2_secondary_uom, "IMUOM3" AS IMUOM3_purchasing_uom, "IMUOM4" AS IMUOM4_pricing_uom, "IMUOM6" AS IMUOM6_shipping_uom, "IMUOM8" AS IMUOM8_production_uom, "IMUOM9" AS IMUOM9_component_uom, "IMUWUM" AS IMUWUM_unit_of_measure_weight, "IMUVM1" AS IMUVM1_unit_of_measure_volume, "IMSUTM" AS IMSUTM_stocking_um, "IMUMVW" AS IMUMVW_psauvolume_or_weight, "IMCYCL" AS IMCYCL_cycle_count_category, "IMGLPT" AS IMGLPT_gl_category, "IMPLEV" AS IMPLEV_sales_price_level, "IMPPLV" AS IMPPLV_purchase_price_level, "IMCLEV" AS IMCLEV_inventory_cost_level, "IMPRPO" AS IMPRPO_gradepotency_pricing, "IMCKAV" AS IMCKAV_check_availability_yn, "IMBPFG" AS IMBPFG_bulkpacked_flag, "IMSRCE" AS IMSRCE_layer_code_source, "IMOT1Y" AS IMOT1Y_potency_control, "IMOT2Y" AS IMOT2Y_grade_control, "IMSTDP" AS IMSTDP_standard_potency, "IMFRMP" AS IMFRMP_from_potency, "IMTHRP" AS IMTHRP_thru_potency, "IMSTDG" AS IMSTDG_standard_grade, "IMFRGD" AS IMFRGD_from_grade, "IMTHGD" AS IMTHGD_thru_grade, "IMCOTY" AS IMCOTY_component_type, "IMSTKT" AS IMSTKT_stocking_type, "IMLNTY" AS IMLNTY_line_type, "IMCONT" AS IMCONT_contract_item, "IMBACK" AS IMBACK_backorders_allowed_yn, "IMIFLA" AS IMIFLA_item_flash_message, "IMTFLA" AS IMTFLA_std_uom_conversion, "IMINMG" AS IMINMG_print_message, "IMABCS" AS IMABCS_abc_code_1_sales, "IMABCM" AS IMABCM_abc_code_2_margin, "IMABCI" AS IMABCI_abc_code_3_investment, "IMOVR" AS IMOVR__abc_code_override_indicator, "IMWARR" AS IMWARR_warranty_item_group, "IMCMCG" AS IMCMCG_commission_category, "IMSRNR" AS IMSRNR_serial_no_required, "IMPMTH" AS IMPMTH_kit_pricing_method, "IMFIFO" AS IMFIFO_fifo_processing, "IMLOTS" AS IMLOTS_lot_status_code, "IMSLD" AS IMSLD__shelf_life_days, "IMANPL" AS IMANPL_planner_number, "IMMPST" AS IMMPST_planning_code, "IMPCTM" AS IMPCTM_percent_margin, "IMMMPC" AS IMMMPC_margin_maintenance_pct, "IMPTSC" AS IMPTSC_material_status, "IMSNS" AS IMSNS__round_to_whole_number, "IMLTLV" AS IMLTLV_leadtime_level, "IMLTMF" AS IMLTMF_leadtime_manufacturing, "IMLTCM" AS IMLTCM_leadtime_cumulative, "IMOPC" AS IMOPC__order_policy_code, "IMOPV" AS IMOPV__value_order_policy, "IMACQ" AS IMACQ__accounting_cost_quantity, "IMMLQ" AS IMMLQ__mfg_leadtime_quantity, "IMLTPU" AS IMLTPU_leadtime_per_unit, "IMMPSP" AS IMMPSP_planning_fence_rule, "IMMRPP" AS IMMRPP_fixedvariable_leadtime, "IMITC" AS IMITC__issue_type_code, "IMORDW" AS IMORDW_order_with_yn, "IMMTF1" AS IMMTF1_planning_fence, "IMMTF2" AS IMMTF2_freeze_fence, "IMMTF3" AS IMMTF3_message_display_fence, "IMMTF4" AS IMMTF4_time_fence, "IMMTF5" AS IMMTF5_shipment_leadtime_offset, "IMEXPD" AS IMEXPD_expedite_damper_days, "IMDEFD" AS IMDEFD_defer_damper_days, "IMSFLT" AS IMSFLT_safety_leadtime, "IMMAKE" AS IMMAKE_makebuy_code, "IMCOBY" AS IMCOBY_cobyproductintermediate, "IMLLX" AS IMLLX__low_level_code, "IMCMGL" AS IMCMGL_commitment_method, "IMCOMH" AS IMCOMH_specific_commitment_days, "IMCSNN" AS IMCSNN_configured_string_id_next_number, "IMURCD" AS IMURCD_user_reserved_code, "IMURDT" AS IMURDT_user_reserved_date, "IMURAT" AS IMURAT_user_reserved_amount, "IMURAB" AS IMURAB_user_reserved_number, "IMURRF" AS IMURRF_user_reserved_reference, "IMUSER" AS IMUSER_user_id, "IMPID" AS IMPID__program_id, "IMJOBN" AS IMJOBN_work_station_id, "IMUPMJ" AS IMUPMJ_date_updated, "IMTDAY" AS IMTDAY_time_of_day 

--INTO etl.F4101_item_master

FROM 
    OPENQUERY (ESYS_PROD, '

	SELECT
		IMITM, IMLITM, IMAITM, IMDSC1, IMDSC2, IMSRTX, IMALN, IMSRP1, IMSRP2, IMSRP3, IMSRP4, IMSRP5, IMSRP6, IMSRP7, IMSRP8, IMSRP9, IMSRP0, IMPRP1, IMPRP2, IMPRP3, IMPRP4, IMPRP5, IMPRP6, IMPRP7, IMPRP8, IMPRP9, IMPRP0, IMCDCD, IMPDGR, IMDSGP, IMPRGR, IMRPRC, IMORPR, IMBUYR, IMDRAW, IMRVNO, IMDSZE, CAST((IMVCUD)/10000.0 AS DEC(15,4)) AS IMVCUD, IMCARS, IMCARP, IMSHCN, IMSHCM, IMUOM1, IMUOM2, IMUOM3, IMUOM4, IMUOM6, IMUOM8, IMUOM9, IMUWUM, IMUVM1, IMSUTM, IMUMVW, IMCYCL, IMGLPT, IMPLEV, IMPPLV, IMCLEV, IMPRPO, IMCKAV, IMBPFG, IMSRCE, IMOT1Y, IMOT2Y, CAST((IMSTDP)/1000.0 AS DEC(15,3)) AS IMSTDP, CAST((IMFRMP)/1000.0 AS DEC(15,3)) AS IMFRMP, CAST((IMTHRP)/1000.0 AS DEC(15,3)) AS IMTHRP, IMSTDG, IMFRGD, IMTHGD, IMCOTY, IMSTKT, IMLNTY, IMCONT, IMBACK, IMIFLA, IMTFLA, IMINMG, IMABCS, IMABCM, IMABCI, IMOVR, IMWARR, IMCMCG, IMSRNR, IMPMTH, IMFIFO, IMLOTS, IMSLD, IMANPL, IMMPST, CAST((IMPCTM)/1000.0 AS DEC(15,3)) AS IMPCTM, CAST((IMMMPC)/1000.0 AS DEC(15,3)) AS IMMMPC, IMPTSC, IMSNS, IMLTLV, IMLTMF, IMLTCM, IMOPC, IMOPV, IMACQ, IMMLQ, CAST((IMLTPU)/100.0 AS DEC(15,2)) AS IMLTPU, IMMPSP, IMMRPP, IMITC, IMORDW, IMMTF1, IMMTF2, IMMTF3, IMMTF4, IMMTF5, IMEXPD, IMDEFD, IMSFLT, IMMAKE, IMCOBY, IMLLX, IMCMGL, IMCOMH, IMCSNN, IMURCD, CASE WHEN IMURDT IS NOT NULL THEN DATE(DIGITS(DEC(IMURDT+ 1900000,7,0))) ELSE NULL END AS IMURDT, CAST((IMURAT)/100.0 AS DEC(15,2)) AS IMURAT, IMURAB, IMURRF, IMUSER, IMPID, IMJOBN, CASE WHEN IMUPMJ IS NOT NULL THEN DATE(DIGITS(DEC(IMUPMJ+ 1900000,7,0))) ELSE NULL END AS IMUPMJ, IMTDAY

	FROM
		ARCPDTA71.F4101
--    WHERE
--        <insert custom code here>
--    ORDER BY
--        <insert custom code here>
')

--------------------------------------------------------------------------------

-- SELECT item_number_short AS IMITM__item_number_short, item_number AS IMLITM_item_number, _3rd_item_number AS IMAITM__3rd_item_number, description AS IMDSC1_description, description_2 AS IMDSC2_description_2, search_text AS IMSRTX_search_text, search_text_compressed AS IMALN__search_text_compressed, sales_catalog_section AS IMSRP1_sales_catalog_section, sub_section AS IMSRP2_sub_section, sales_category_code_3 AS IMSRP3_sales_category_code_3, sales_category_code_4 AS IMSRP4_sales_category_code_4, sales_category_code_5 AS IMSRP5_sales_category_code_5, category_code_6 AS IMSRP6_category_code_6, category_code_7 AS IMSRP7_category_code_7, category_code_8 AS IMSRP8_category_code_8, category_code_9 AS IMSRP9_category_code_9, category_code_10 AS IMSRP0_category_code_10, commodity_class AS IMPRP1_commodity_class, commodity_sub_class AS IMPRP2_commodity_sub_class, supplier_rebate_code AS IMPRP3_supplier_rebate_code, master_planning_family AS IMPRP4_master_planning_family, landed_cost_rule AS IMPRP5_landed_cost_rule, item_dimension_group AS IMPRP6_item_dimension_group, warehouse_process_grp_1 AS IMPRP7_warehouse_process_grp_1, warehouse_process_grp_2 AS IMPRP8_warehouse_process_grp_2, warehouse_process_grp_3 AS IMPRP9_warehouse_process_grp_3, item_pool_code AS IMPRP0_item_pool_code, commodity_code AS IMCDCD_commodity_code, product_group AS IMPDGR_product_group, dispatch_group AS IMDSGP_dispatch_group, item_price_group AS IMPRGR_item_price_group, basket_reprice_group AS IMRPRC_basket_reprice_group, order_reprice_group AS IMORPR_order_reprice_group, buyer_number AS IMBUYR_buyer_number, drawing_number AS IMDRAW_drawing_number, last_revision_no AS IMRVNO_last_revision_no, drawing_size AS IMDSZE_drawing_size, volume_cubic_dimensions AS IMVCUD_volume_cubic_dimensions, carrier_number AS IMCARS_carrier_number, preferred_carrier_purchasing AS IMCARP_preferred_carrier_purchasing, shipping_conditions_code AS IMSHCN_shipping_conditions_code, shipping_commodity_class AS IMSHCM_shipping_commodity_class, unit_of_measure AS IMUOM1_unit_of_measure, secondary_uom AS IMUOM2_secondary_uom, purchasing_uom AS IMUOM3_purchasing_uom, pricing_uom AS IMUOM4_pricing_uom, shipping_uom AS IMUOM6_shipping_uom, production_uom AS IMUOM8_production_uom, component_uom AS IMUOM9_component_uom, unit_of_measure_weight AS IMUWUM_unit_of_measure_weight, unit_of_measure_volume AS IMUVM1_unit_of_measure_volume, stocking_um AS IMSUTM_stocking_um, psauvolume_or_weight AS IMUMVW_psauvolume_or_weight, cycle_count_category AS IMCYCL_cycle_count_category, gl_category AS IMGLPT_gl_category, sales_price_level AS IMPLEV_sales_price_level, purchase_price_level AS IMPPLV_purchase_price_level, inventory_cost_level AS IMCLEV_inventory_cost_level, gradepotency_pricing AS IMPRPO_gradepotency_pricing, check_availability_yn AS IMCKAV_check_availability_yn, bulkpacked_flag AS IMBPFG_bulkpacked_flag, layer_code_source AS IMSRCE_layer_code_source, potency_control AS IMOT1Y_potency_control, grade_control AS IMOT2Y_grade_control, standard_potency AS IMSTDP_standard_potency, from_potency AS IMFRMP_from_potency, thru_potency AS IMTHRP_thru_potency, standard_grade AS IMSTDG_standard_grade, from_grade AS IMFRGD_from_grade, thru_grade AS IMTHGD_thru_grade, component_type AS IMCOTY_component_type, stocking_type AS IMSTKT_stocking_type, line_type AS IMLNTY_line_type, contract_item AS IMCONT_contract_item, backorders_allowed_yn AS IMBACK_backorders_allowed_yn, item_flash_message AS IMIFLA_item_flash_message, std_uom_conversion AS IMTFLA_std_uom_conversion, print_message AS IMINMG_print_message, abc_code_1_sales AS IMABCS_abc_code_1_sales, abc_code_2_margin AS IMABCM_abc_code_2_margin, abc_code_3_investment AS IMABCI_abc_code_3_investment, abc_code_override_indicator AS IMOVR__abc_code_override_indicator, warranty_item_group AS IMWARR_warranty_item_group, commission_category AS IMCMCG_commission_category, serial_no_required AS IMSRNR_serial_no_required, kit_pricing_method AS IMPMTH_kit_pricing_method, fifo_processing AS IMFIFO_fifo_processing, lot_status_code AS IMLOTS_lot_status_code, shelf_life_days AS IMSLD__shelf_life_days, planner_number AS IMANPL_planner_number, planning_code AS IMMPST_planning_code, percent_margin AS IMPCTM_percent_margin, margin_maintenance_pct AS IMMMPC_margin_maintenance_pct, material_status AS IMPTSC_material_status, round_to_whole_number AS IMSNS__round_to_whole_number, leadtime_level AS IMLTLV_leadtime_level, leadtime_manufacturing AS IMLTMF_leadtime_manufacturing, leadtime_cumulative AS IMLTCM_leadtime_cumulative, order_policy_code AS IMOPC__order_policy_code, value_order_policy AS IMOPV__value_order_policy, accounting_cost_quantity AS IMACQ__accounting_cost_quantity, mfg_leadtime_quantity AS IMMLQ__mfg_leadtime_quantity, leadtime_per_unit AS IMLTPU_leadtime_per_unit, planning_fence_rule AS IMMPSP_planning_fence_rule, fixedvariable_leadtime AS IMMRPP_fixedvariable_leadtime, issue_type_code AS IMITC__issue_type_code, order_with_yn AS IMORDW_order_with_yn, planning_fence AS IMMTF1_planning_fence, freeze_fence AS IMMTF2_freeze_fence, message_display_fence AS IMMTF3_message_display_fence, time_fence AS IMMTF4_time_fence, shipment_leadtime_offset AS IMMTF5_shipment_leadtime_offset, expedite_damper_days AS IMEXPD_expedite_damper_days, defer_damper_days AS IMDEFD_defer_damper_days, safety_leadtime AS IMSFLT_safety_leadtime, makebuy_code AS IMMAKE_makebuy_code, cobyproductintermediate AS IMCOBY_cobyproductintermediate, low_level_code AS IMLLX__low_level_code, commitment_method AS IMCMGL_commitment_method, specific_commitment_days AS IMCOMH_specific_commitment_days, configured_string_id_next_number AS IMCSNN_configured_string_id_next_number, user_reserved_code AS IMURCD_user_reserved_code, user_reserved_date AS IMURDT_user_reserved_date, user_reserved_amount AS IMURAT_user_reserved_amount, user_reserved_number AS IMURAB_user_reserved_number, user_reserved_reference AS IMURRF_user_reserved_reference, user_id AS IMUSER_user_id, program_id AS IMPID__program_id, work_station_id AS IMJOBN_work_station_id, date_updated AS IMUPMJ_date_updated, time_of_day AS IMTDAY_time_of_day FROM <...>

